DROP VIEW EXTERNALONDEMANDBALANCING;

/* Formatted on 6/19/2022 4:56:35 PM (QP5 v5.256.13226.35538) */
CREATE OR REPLACE FORCE VIEW EXTERNALONDEMANDBALANCING
(
   ACCCODE,
   ACCCURRENTBALANCE
)
   BEQUEATH DEFINER
AS
   SELECT ac.ACCCODE, ac.ACCCURRENTBALANCE
     FROM UBL111121.Account ac, Accounts tac
    WHERE AC.ACCCODE = TAC.ACCNO AND TAC.DISCRIMINATOR = 'V';
	
-------------------------------------------------------------------------------------------



DROP VIEW EXTERNATERMDEPBALANCING;

/* Formatted on 6/19/2022 4:59:00 PM (QP5 v5.256.13226.35538) */
CREATE OR REPLACE FORCE VIEW EXTERNATERMDEPBALANCING
(
   ACCCODE,
   ACCNAME,
   ACCTIVATION_DATE,
   RENEW_DATE,
   EXPIRE_DATE,
   PROFITRATE,
   ACCCURRENTBALANCE,
   TENURECOUNT,
   TENURETYPE
)
   BEQUEATH DEFINER
AS
   SELECT A.ACCNO AS ACCCODE,
          A.ACCNAME AS accname,
          A.ACCACTIVATIONDATE AS acctivation_date,
          A.ACCRENEWALDATE AS renew_Date,
          A.ACCEXPIRYDATE + 1 AS expire_Date,
          CASE
             WHEN a.ACCFIXEDPROFITRATE IS NULL THEN A.ACCPROFITRATE
             ELSE a.ACCFIXEDPROFITRATE
          END
             AS profitrate,
          A.ACCBALANCE AS ACCCURRENTBALANCE,
          P.PRODMONTH AS TENURECOUNT,
          'Monthly' AS tenuretype
     FROM UBL111121.SSP_ACCOUNT A, UBL111121.SSP_PRODUCT P, Accounts tac
    WHERE     A.ACCPRODID = P.PRODID
          AND UPPER (P.PRODISRECURRING) = 'FALSE'
          AND a.ACCSTATUS = 'REGULAR'
          AND A.ACCNO = TAC.ACCNO
          AND TAC.DISCRIMINATOR = 'D';
	
	
	
	
